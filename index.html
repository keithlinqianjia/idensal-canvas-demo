<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>idensal ¬∑ Profile Demo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    .no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
    html,body{height:100%;background:#f7fafc}
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- Compact TSX app -->
  <script type="text/babel" data-type="module" data-presets="typescript,react">
    const {useState} = React;

    const PROS = [
      { handle:"sam.cleaning", displayName:"Sam Smith", title:"End-of-tenancy specialist", cat:"Cleaning", distance:"0.4 mi",
        coords:{x:32,y:52}, about:"Move-out deep cleans with guaranteed checklist.",
        avatar:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?q=80&w=400&auto=format&fit=crop", postal:"G12 8QQ" },
      { handle:"deepgloss.clean", displayName:"Deep Gloss", title:"Deep Clean Team", cat:"Cleaning", distance:"0.6 mi",
        coords:{x:45,y:40}, about:"Steam & eco products.",
        avatar:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=400&auto=format&fit=crop", postal:"G11 6RN" },
      { handle:"mr-fixit", displayName:"Mr Fixit", title:"Emergency plumber 24/7", cat:"Plumbing", distance:"0.7 mi",
        coords:{x:42,y:68}, about:"Gas Safe partner network.",
        avatar:"https://images.unsplash.com/photo-1595152772835-219674b2a8a6?q=80&w=400&auto=format&fit=crop", postal:"G3 7QF" }
    ];

    function SimMap({pins=[],label="Centered near your area",you,onSelectPin}){
      return (
        <div className="absolute inset-0 bg-blue-50">
          <svg className="absolute inset-0 w-full h-full" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
            <rect x="0" y="0" width="100%" height="100%" fill="#e6f0ff" />
            <g stroke="#c5d6f5" strokeWidth="2" fill="none" opacity="0.9">
              <path d="M0,40 C120,60 200,20 420,60" />
              <path d="M0,200 C160,180 260,220 420,200" />
              <path d="M60,0 C80,120 140,160 160,300" />
              <path d="M300,0 C280,100 260,220 240,320" />
            </g>
          </svg>
          <div className="absolute inset-0 flex items-center justify-center text-gray-600 pointer-events-none select-none">
            <div className="text-center"><div>üìç</div><div className="text-sm">{label}</div></div>
          </div>
          <div className="absolute inset-0">
            {you && (
              <div className="absolute -translate-x-1/2 -translate-y-full" style={{left:(you.x||50)+'%',top:(you.y||50)+'%'}}>
                <div className="text-blue-700">üìç</div>
              </div>
            )}
            {pins.map((p,i)=>(
              <div key={(p.handle||'p')+i} className="absolute -translate-x-1/2 -translate-y-full cursor-pointer"
                   style={{left:((p.coords&&p.coords.x)||50)+'%',top:((p.coords&&p.coords.y)||50)+'%'}}
                   onClick={(e)=>{e.stopPropagation();onSelectPin&&onSelectPin(p);}}>
                <div className="w-max mx-auto -mb-1 select-none text-[10px] font-medium leading-none text-gray-900">@{p.handle}.uk</div>
                {p.avatar ? <img src={p.avatar} alt={p.displayName||p.handle} className="h-9 w-9 rounded-full object-cover ring-2 ring-white shadow-md"/> :
                  <div className="h-9 w-9 rounded-full bg-gray-200 grid place-items-center text-[11px] text-gray-700 ring-2 ring-white shadow-md">{(p.displayName||p.handle||'U').slice(0,1).toUpperCase()}</div>}
              </div>
            ))}
          </div>
        </div>
      );
    }

    function Card({pro,onMsg,onSelect}){
      const outward=(s)=>{if(!s)return"";const str=String(s).trim().toUpperCase().split(' ');return str[0]||"";}
      const area=outward(pro.postal);
      return (
        <div className="p-3 border rounded-2xl mb-3 bg-white shadow-sm cursor-pointer relative" onClick={()=>onSelect&&onSelect(pro)}>
          <div className="text-xs font-semibold text-gray-900 truncate pr-14">@{pro.handle}.uk</div>
          <div className="mt-1 flex items-center gap-3 pr-14">
            {pro.avatar ? <img src={pro.avatar} alt={pro.displayName} className="h-14 w-14 rounded-full object-cover"/> :
              <div className="h-14 w-14 rounded-full bg-gray-200 grid place-items-center text-base font-medium text-gray-700">{(pro.displayName||'U').slice(0,1)}</div>}
            <div className="min-w-0">
              <div className="text-sm text-gray-900 truncate">{pro.displayName}</div>
              <div className="text-sm text-gray-600 truncate">{pro.title}</div>
              {area ? <div className="text-xs text-gray-700 mt-0.5">{area}</div> : null}
            </div>
          </div>
          <button className="absolute right-3 top-1/2 -translate-y-1/2 px-3 py-1 rounded-xl text-sm bg-black text-white"
                  onClick={(e)=>{e.stopPropagation();onMsg&&onMsg(pro);}}>Message</button>
        </div>
      );
    }

    function ProfileModal({pro,onClose,onMsg}){
      if(!pro) return null;
      const pics=[
        "https://images.unsplash.com/photo-1556910096-6f5e72db6809?q=80&w=800&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1556910103-1c02745aae4d?q=80&w=800&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1527515637462-cff94eecc1ac?q=80&w=800&auto=format&fit=crop"
      ];
      return (
        <div className="absolute inset-0 z-50">
          <div className="absolute inset-0 bg-black/40" onClick={onClose} />
          <div className="absolute inset-x-0 bottom-0 bg-white rounded-t-3xl border-t shadow-2xl max-h-[88%] overflow-auto">
            <div className="h-14 px-4 border-b flex items-center justify-between sticky top-0 bg-white/95 backdrop-blur z-10">
              <button className="text-gray-700" onClick={onClose}>‚úï</button>
              <div className="text-sm text-gray-600">Profile</div><span className="w-6"/>
            </div>
            <div className="px-5 pt-4 pb-2">
              <div className="text-xs font-semibold text-gray-900 truncate">@{pro.handle}.uk</div>
              <div className="mt-1 flex items-center gap-3">
                {pro.avatar ? <img src={pro.avatar} alt={pro.displayName} className="h-14 w-14 rounded-full object-cover"/> :
                  <div className="h-14 w-14 rounded-full bg-gray-200 grid place-items-center text-base font-medium text-gray-700">{(pro.displayName||"U").slice(0,1)}</div>}
                <div className="min-w-0">
                  <div className="text-sm text-gray-900 truncate">{pro.displayName}</div>
                  <div className="text-sm text-gray-600 truncate">{pro.title}</div>
                </div>
                <div className="ml-2"><button className="px-3 py-1 rounded-xl text-sm bg-black text-white" onClick={()=>onMsg&&onMsg(pro)}>Message</button></div>
              </div>
            </div>
            <div className="px-5 pt-2">
              <h3 className="text-base font-semibold text-gray-900">About</h3>
              <p className="mt-2 text-sm text-gray-700 leading-relaxed">{pro.about||"This provider hasn't added an about yet."}</p>
            </div>
            <div className="px-5 pt-4 pb-6">
              <h3 className="text-base font-semibold text-gray-900">Photos</h3>
              <div className="mt-3 grid grid-cols-3 gap-2">
                {pics.map((src,i)=>(<img key={i} src={src} alt={"Photo "+(i+1)} className="h-24 w-full object-cover rounded-xl" />))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    function Home({onOpenDetail,onMsg}){
      const base=PROS.slice();
      return (
        <div className="relative h-full">
          <SimMap pins={base} you={{x:46,y:64}} label="Pins near you" onSelectPin={onOpenDetail}/>
          <div className="absolute left-0 right-0 top-0">
            <div className="h-14 border-b bg-white/95 backdrop-blur flex items-center justify-between px-4">
              <div className="text-base font-semibold">idensal</div>
              <div className="text-xs text-gray-600 whitespace-nowrap">people by area</div>
            </div>
            <div className="mx-4 mt-2 flex items-center gap-2 bg-white/95 backdrop-blur border rounded-2xl px-3 py-2 shadow">
              <span className="text-gray-400">üîé</span>
              <input className="flex-1 outline-none text-sm text-gray-700 placeholder-gray-400" placeholder="key words (e.g., cleaner, plumber)" />
            </div>
          </div>
          <div className="absolute left-0 right-0 bottom-0 z-10">
            <div className="overflow-auto no-scrollbar rounded-t-2xl bg-white/95 backdrop-blur border-t p-3 shadow-xl" style={{height:170}}>
              <div className="flex justify-center"><div className="h-1.5 w-10 bg-gray-300 rounded-full mb-2"/></div>
              {base.map((p)=>(<Card key={p.handle} pro={p} onMsg={onMsg} onSelect={onOpenDetail}/>))}
            </div>
          </div>
        </div>
      );
    }

    function App(){
      const [viewProfile,setViewProfile]=useState(null);
      const [activeTab,setActiveTab]=useState("Home");
      const requireLoginThen=(intent)=>{alert("Demo: auth flow not wired. Proceeding to "+intent.type); if(intent.type==="message"){setActiveTab("Chat");}};
      return (
        <div className="min-h-screen bg-gray-50 p-4">
          <div className="mx-auto max-w-[420px] rounded-3xl border border-gray-200 bg-white shadow-xl overflow-hidden">
            <div className="flex h-[780px] flex-col">
              <div className="flex-1 overflow-hidden relative">
                {activeTab==="Home" && <Home onOpenDetail={(pro)=>setViewProfile(pro)} onMsg={(pro)=>requireLoginThen({type:"message",pro})}/>}
                {activeTab==="Chat" && <div className="absolute inset-0 p-4">üí¨ <span className="text-sm text-gray-600">Messages view (demo)</span></div>}
                {viewProfile && <ProfileModal pro={viewProfile} onClose={()=>setViewProfile(null)} onMsg={(pro)=>requireLoginThen({type:"message",pro})}/>}
              </div>
              <nav className="grid grid-cols-3 border-t bg-white">
                {["Home","Chat","Profile"].map((label)=>(
                  <button key={label} onClick={()=>setActiveTab(label)} className={\`h-14 text-xs \${activeTab===label?"font-semibold text-gray-900":"text-gray-500"} flex flex-col items-center justify-center gap-0.5\`}>
                    <span className="text-lg">{label==="Home"?"üè†":label==="Chat"?"üí¨":"üë§"}</span>
                    <span>{label}</span>
                  </button>
                ))}
              </nav>
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(React.createElement(App));
  </script>
</body>
</html>
