<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>idensal Canvas Demo ‚Äî Match Doc</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .no-scrollbar::-webkit-scrollbar{display:none}
    .no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
  </style>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const {useState, useRef, useEffect} = React;

    /**************** Data ****************/
    const CATEGORIES = [
      { name:"Cleaning", subs:["Carpet & upholstery","Household cleaning","End of tenancy clean","After builders clean","Gutter/soffit clean","Jet-wash patios/drives","Other"] },
      { name:"Heating & Gas", subs:["Boiler service","CP12 (landlord)","Boiler repair callout","TRVs & balancing","System power flush","Smart thermostat fit","Other"] },
      { name:"Plumbing", subs:["Emergency leaks","Toilet repair/replace","Shower valve swap","Tap swap (kitchen/bath)","Leak trace & repair","Outdoor tap install","Other"] },
      { name:"Electrical & Smart", subs:["EICR (inspection)","Consumer unit upgrade","Electric shower fit","Oven/hob connection","Security/PIR lighting","EV charger install","Other"] },
      { name:"Roofing & Gutters", subs:["Gutter clear/repair","Moss remove & treat","Soffit/fascia repair","Velux/skylight reseal","Roof leak repair","Tile/slate replace","Other"] },
      { name:"Windows & Doors", subs:["Misted unit replace","Composite door fit","Reseal & draught-proof","Lock/hinge/handle fix","Align/adjust doors","Conservatory repairs","Other"] },
      { name:"Joinery & Finishes", subs:["Plaster/skimming","Tiling (kitchen/bath)","Doors/skirting/arches","Stud wall/partition","Laminate/LVT flooring","Painting & decorating","Other"] },
      { name:"Handyman", subs:["Draught-proof doors","Silicone/grout refresh","Patch & paint touch-ups","Door plane/hinge/latch","Blinds/curtain tracks","TV mount & shelving","Other"] },
      { name:"Gardens & Driveways", subs:["Hedge cut/reduce","Jet-wash drive/patio","Fence/post repair","Garden clear-out","Decking build/repair","Driveway repairs","Other"] },
      { name:"Removals & Waste", subs:["Man & van (hourly)","Student/flat moves","Furniture dis/re-assemble","Bulky waste / HIPPO","House/loft/garage clear","Other"] },
      { name:"Care (Children & Elderly)", subs:["Babysitting","Holiday/backup cover","SEN-aware support","Elderly companionship","Personal care visits","Other"] },
      { name:"Events", subs:["Food & Drink","Food trucks","Markets","Experiences","Other"] },
      { name:"Others", subs:["Others"] },
    ];

    const PROS = [
      { handle:"sparkle.clean", displayName:"Sparkle Clean", title:"End-of-tenancy specialist", distance:"0.4 mi", short:"Deep clean ‚Ä¢ Windows", cat:"Cleaning", coords:{x:32,y:52}, about:"Professional home & Airbnb cleaners covering deep cleans and end‚Äëof‚Äëtenancy." },
      { handle:"deepgloss.clean", displayName:"Deep Gloss", title:"Deep Clean Team", distance:"0.6 mi", short:"Deep clean ‚Ä¢ Carpets", cat:"Cleaning", coords:{x:45,y:40}, about:"Steam & eco products." },
      { handle:"mr-fixit", displayName:"Mr Fixit", title:"Emergency plumber 24/7", distance:"0.7 mi", short:"Leaks ‚Ä¢ Drains", cat:"Plumbing", coords:{x:42,y:68}, about:"Gas Safe partner network." },
    ];

    const EMOJI = {"Cleaning":"üßπ","Handyman":"üõ†Ô∏è","Removals & Waste":"üöö"};
    const emojiFor=(n)=>EMOJI[n]||"‚ú®";
    const toMiles=(d)=>parseFloat(String(d).replace(/[^0-9.]/g,""))||0;

    /**************** Local user store ****************/
    const LS_KEY="idensal.user";
    const loadUser=()=>{try{return JSON.parse(localStorage.getItem(LS_KEY)||"null");}catch{return null;}};
    const saveUser=(u)=>{try{localStorage.setItem(LS_KEY,JSON.stringify(u));}catch{}};
    const clearUser=()=>{try{localStorage.removeItem(LS_KEY);}catch{}};

    /**************** Map ****************/
    function SimMap({ pins=[], label="Centered near your area", you, onSelectPin }){
      return (
        <div className="absolute inset-0 bg-blue-50">
          <svg className="absolute inset-0 w-full h-full" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
            <rect x="0" y="0" width="100%" height="100%" fill="#e6f0ff" />
            <g stroke="#c5d6f5" strokeWidth="2" fill="none" opacity="0.9">
              <path d="M0,40 C120,60 200,20 420,60" />
              <path d="M0,200 C160,180 260,220 420,200" />
              <path d="M60,0 C80,120 140,160 160,300" />
              <path d="M300,0 C280,100 260,220 240,320" />
            </g>
          </svg>
          <div className="absolute inset-0">
            {pins.map((p,i)=>(
              <div key={p.handle} className="absolute -translate-x-1/2 -translate-y-full cursor-pointer"
                   style={{left:(p.coords?.x||50)+'%', top:(p.coords?.y||50)+'%'}}
                   onClick={()=>onSelectPin&&onSelectPin(p)}>
                <div className="w-max mx-auto -mb-1 select-none text-[12px] font-medium drop-shadow text-[#F59E0B]">@{p.handle}.uk</div>
                <div className="h-5 w-5 bg-yellow-400 rounded-md border-2 border-white shadow" />
              </div>
            ))}
          </div>
          <div className="absolute inset-0 flex items-center justify-center text-gray-600 pointer-events-none">
            <div className="text-sm">{label}</div>
          </div>
        </div>
      );
    }

    /**************** View-only Profile Modal (from Home) ****************/
    function ProfileModal({ pro, onClose }){
      if(!pro) return null;
      const handle="@"+pro.handle+".uk";
      return (
        <div className="absolute inset-0 z-50">
          <div className="absolute inset-0 bg-black/40" onClick={onClose} />
          <div className="absolute inset-x-0 bottom-0 bg-white rounded-t-3xl border-t shadow-2xl max-h-[88%] overflow-auto">
            <div className="h-14 px-4 border-b flex items-center justify-between sticky top-0 bg-white/95 backdrop-blur z-10">
              <button aria-label="Close" className="text-gray-700" onClick={onClose}>‚úï</button>
              <div className="text-sm text-gray-600">Profile</div>
              <span className="w-6" />
            </div>
            <div className="px-5 pt-4 pb-2 flex items-center gap-4">
              <div className="h-16 w-16 rounded-full bg-gray-200 grid place-items-center text-base font-medium text-gray-700">{pro.displayName[0]}</div>
              <div className="flex-1 min-w-0">
                <div className="text-sm text-gray-500 truncate">{handle}</div>
                <div className="text-lg font-semibold truncate">{pro.displayName}</div>
                <div className="text-sm text-gray-600 truncate">{pro.title}</div>
                <div className="text-xs text-gray-500 mt-1">Distance: {pro.distance} ‚Ä¢ Category: {pro.cat||"‚Äî"}</div>
              </div>
            </div>
            <div className="px-5 pt-2">
              <h3 className="text-base font-semibold text-gray-900">About</h3>
              <p className="mt-2 text-sm text-gray-700 leading-relaxed">{pro.about}</p>
            </div>
          </div>
        </div>
      );
    }

    /**************** Cards ****************/
    function Card({ pro, onSelect }){
      return (
        <div className="p-3 border rounded-2xl mb-3 bg-white shadow-sm cursor-pointer" style={{height:120}} onClick={()=>onSelect&&onSelect(pro)}>
          <div className="flex items-start justify-between gap-3">
            <div className="h-12 w-12 rounded-full bg-gray-200 grid place-items-center text-sm font-medium text-gray-700">{pro.displayName[0]}</div>
            <div className="flex-1 min-w-0">
              <div className="font-semibold truncate">@{pro.handle}.uk</div>
              <div className="text-sm text-gray-600 -mt-0.5 truncate">{pro.title}</div>
              <div className="text-sm text-gray-700 mt-1 truncate">{pro.short}</div>
            </div>
            <div className="flex flex-col items-end gap-2 ml-2 flex-shrink-0">
              <span className="text-xs text-gray-500 whitespace-nowrap">{pro.distance}</span>
              <button className="px-2 py-1 rounded-lg text-xs border">üß≠ Navigate</button>
            </div>
          </div>
        </div>
      );
    }

    /**************** Home ****************/
    function Home({ onOpenDetail, selectedCat, onMore }){
      const [youPos] = useState({x:46,y:64});
      const list=(selectedCat? PROS.filter(p=>p.cat===selectedCat):PROS).slice().sort((a,b)=>toMiles(a.distance)-toMiles(b.distance));
      const [sheetOpen, setSheetOpen]=useState(false);
      const startY=useRef(null);
      const onTouchStart=(e)=>startY.current=e.touches[0].clientY;
      const onTouchMove=(e)=>{ if(startY.current==null) return; const dy=e.touches[0].clientY-startY.current; if(dy<-20) setSheetOpen(true); if(dy>20) setSheetOpen(false); };
      const onTouchEnd=()=>startY.current=null;

      return (
        <div className="relative h-full">
          <SimMap pins={list} you={youPos} label={selectedCat? (selectedCat+' ‚Äì pins near you'): 'Centered near your area'} onSelectPin={onOpenDetail} />
          <div className="absolute left-0 right-0" style={{top:0}}>
            <div className="h-14 border-b bg-white/95 backdrop-blur flex items-center justify-between px-4">
              <div className="text-base font-semibold tracking-tight">idensal</div>
              <div className="text-xs text-gray-600 whitespace-nowrap">your neighborhood</div>
            </div>
            <div className="mx-4 mt-2 flex items-center gap-2 bg-white/95 backdrop-blur border rounded-2xl px-3 py-2 shadow">
              <span className="text-gray-400">üîé</span>
              <input className="flex-1 outline-none text-sm text-gray-700 placeholder-gray-400" placeholder="key words (e.g., cleaner, boiler engineer)" />
            </div>
            <div className="mt-2 mx-4 flex overflow-x-auto no-scrollbar whitespace-nowrap">
              {["Cleaning","Handyman","Removals & Waste","More"].map(n=>(
                <button key={n} className="flex-none px-3 py-1 rounded-full border text-sm mr-2 bg-white" onClick={()=>{ if(n==="More"){ onMore&&onMore(); } }}>{n==="More" ? "‚ûï More": (emojiFor(n)+" "+n)}</button>
              ))}
            </div>
          </div>
          <div className="absolute left-0 right-0 bottom-0 z-10">
            <div className="overflow-auto no-scrollbar rounded-t-2xl bg-white/95 backdrop-blur border-t p-3 shadow-xl" style={{height: sheetOpen? "60%": 170}} onTouchStart={onTouchStart} onTouchMove={onTouchMove} onTouchEnd={onTouchEnd}>
              <div className="flex justify-center"><button onClick={()=>setSheetOpen(!sheetOpen)} className="h-1.5 w-10 bg-gray-300 rounded-full mb-2" aria-label="Expand results" /></div>
              {list.map(p=>(<Card key={p.handle} pro={p} onSelect={onOpenDetail} />))}
            </div>
          </div>
        </div>
      );
    }

    /**************** Categories ****************/
    function Categories({ onPick }){
      const [q,setQ]=useState("");
      const [open,setOpen]=useState(CATEGORIES[0].name);
      const filtered=CATEGORIES.map(cat=>({
        ...cat,
        show: q? (cat.name.toLowerCase().includes(q.toLowerCase()) || (cat.subs||[]).some(s=>s.toLowerCase().includes(q.toLowerCase()))): true,
        subs: q? (cat.subs||[]).filter(s=>s.toLowerCase().includes(q.toLowerCase())): (cat.subs||[]),
      })).filter(c=>c.show);
      return (
        <div className="absolute inset-0 no-scrollbar">
          <div className="h-14 border-b bg-white/95 backdrop-blur flex items-center px-4"><div className="text-base font-semibold">Categories</div></div>
          <div className="absolute inset-x-0 bottom-0 top-14 overflow-auto p-4">
            <div className="flex items-center gap-2 bg-white border rounded-2xl px-3 py-2 shadow-sm mb-3"><span>üîé</span><input value={q} onChange={(e)=>setQ(e.target.value)} className="flex-1 outline-none text-sm" placeholder="Search categories & subs" /></div>
            {filtered.map(cat=>(
              <div key={cat.name} className="mb-3 bg-white rounded-2xl border overflow-hidden">
                <div className="p-3 flex items-center justify-between cursor-pointer" onClick={()=>setOpen(open===cat.name ? "": cat.name)}>
                  <div className="font-medium">{cat.name}</div>
                  <div className="w-8 h-8 rounded-full border flex items-center justify-center bg-gray-50">{open===cat.name ? "‚Äì" : "+"}</div>
                </div>
                {open===cat.name && (
                  <div className="px-3 pb-3 flex flex-wrap">
                    {cat.subs.map(s=>(<button key={s} onClick={()=>onPick(cat.name)} className="px-3 py-1 rounded-full border text-sm mr-2 mb-2 bg-white">{s}</button>))}
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      );
    }

    /**************** Messages (unchanged) ****************/
    function Messages(){
      const [draft,setDraft]=useState("");
      const [items,setItems]=useState([{type:"text",me:false,text:"Hi! I found you on idensal.",time:"10:14"},{type:"text",me:true,text:"Thanks! What date suits?",time:"10:15"}]);
      const fileRef=useRef(null);
      const attach=()=>fileRef.current?.click();
      const onFile=(e)=>{const f=e.target?.files?.[0]; if(!f) return; const url=URL.createObjectURL(f); setItems(p=>p.concat([{type:"image",me:true,url,time:"now"}])); e.target.value="";};
      const send=()=>{ if(!draft.trim()) return; setItems(p=>p.concat([{type:"text",me:true,text:draft.trim(),time:"now"}])); setDraft("");}
      return (
        <div className="relative flex flex-col h-full">
          <div className="h-14 p-3 border-b bg-white flex items-center gap-2"><div className="font-medium">Messages</div><div className="ml-auto text-xs text-gray-500">In-app notifications</div></div>
          <div className="flex-1 overflow-auto p-3 pb-36 bg-gray-50 no-scrollbar">
            <div className="text-center text-xs text-gray-500 mb-2">Today</div>
            {items.map((it,idx)=> it.type==="image" ? (
              <div key={idx} className="flex justify-end my-1"><div className="max-w-[78%] rounded-2xl overflow-hidden text-sm shadow bg-black text-white rounded-br-sm"><img src={it.url} className="w-56 h-36 object-cover" /><p className="text-[10px] mt-0 px-3 py-1 text-gray-200">{it.time}</p></div></div>
            ):(
              <div key={idx} className={"flex "+(it.me?"justify-end":"justify-start")+" my-1"}><div className={"max-w-[78%] rounded-2xl px-3 py-2 text-sm shadow "+(it.me?"bg-black text-white rounded-br-sm":"bg-gray-100 rounded-bl-sm")}><p>{it.text}</p><p className={"text-[10px] mt-1 "+(it.me?"text-gray-200":"text-gray-500")}>{it.time}</p></div></div>
            ))}
          </div>
          <div className="absolute bottom-0 left-0 right-0 z-30 p-2 bg-white border-t flex items-center gap-2">
            <button onClick={attach} className="w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center">üìé</button>
            <input type="file" accept="image/*" ref={fileRef} className="hidden" onChange={onFile} />
            <input value={draft} onChange={(e)=>setDraft(e.target.value)} className="flex-1 px-3 py-2 bg-gray-100 rounded-xl outline-none text-sm" placeholder="Write a message" />
            <button onClick={send} className="w-10 h-10 rounded-xl bg-black text-white flex items-center justify-center">‚û§</button>
          </div>
        </div>
      );
    }

    /**************** Profile Tab: login ‚Üí claim handle ‚Üí edit ****************/
    function ProfileTab({ onPreview }){
      const TAKEN=["sparkleclean","idensal","admin","support","test"];
      const [user,setUser]=useState(loadUser());
      const [mode,setMode]=useState("login");     // 'login' | 'signup'
      const [step,setStep]=useState(user? "edit":"auth"); // 'auth' | 'claim' | 'edit'
      const [form,setForm]=useState({email:"",password:"",username:user?.username||"",displayName:user?.displayName||"",headline:user?.headline||"",about:user?.about||""});
      const [checking,setChecking]=useState(false), [taken,setTaken]=useState(false);

      const update=(k,v)=>setForm(f=>({...f,[k]:v}));
      const canAuth=form.email && form.password;
      const validUsername=/^[a-z0-9_.]{3,20}$/i.test(form.username||"");
      const checkUsername=(v)=>{ setChecking(true); setTimeout(()=>{ const x=(v||"").trim().toLowerCase(); setTaken(x && TAKEN.includes(x)); setChecking(false); },200); };

      function completeAuth(){
        if(mode==="signup"){ setStep("claim"); return; }
        const u={email:form.email,username:form.username||"demo.user",displayName:"Sparkle Clean",headline:"End‚Äëof‚Äëtenancy specialist",about:"Professional home & Airbnb cleaners."};
        setUser(u); saveUser(u); setStep("edit"); setForm(f=>({...u,password:""}));
      }
      function finishClaim(){
        if(!validUsername || taken || checking) return;
        const u={email:form.email,username:form.username,displayName:"Sparkle Clean",headline:"End‚Äëof‚Äëtenancy specialist",about:"Professional home & Airbnb cleaners."};
        setUser(u); saveUser(u); setStep("edit"); setForm(f=>({...u,password:""}));
      }
      function saveProfile(){
        const u={ email:form.email, username:form.username||user?.username||"demo.user", displayName:form.displayName||"Sparkle Clean", headline:form.headline||"End‚Äëof‚Äëtenancy specialist", about:form.about||"Professional home & Airbnb cleaners." };
        setUser(u); saveUser(u);
      }
      function logout(){ clearUser(); setUser(null); setForm({email:"",password:"",username:"",displayName:"",headline:"",about:""}); setMode("login"); setStep("auth"); }

      if(step==="auth"){
        return (
          <div className="p-5 space-y-4">
            <div className="flex gap-2 text-sm">
              <button className={"px-3 py-1 rounded-full border "+(mode==='login'?'bg-black text-white':'')} onClick={()=>setMode('login')}>Log in</button>
              <button className={"px-3 py-1 rounded-full border "+(mode==='signup'?'bg-black text-white':'')} onClick={()=>setMode('signup')}>Sign up</button>
            </div>
            <label className="block text-sm">Email<input className="mt-1 w-full rounded-xl border px-3 py-2" value={form.email} onChange={(e)=>update('email',e.target.value)} placeholder="you@email.com" /></label>
            <label className="block text-sm">Password<input type="password" className="mt-1 w-full rounded-xl border px-3 py-2" value={form.password} onChange={(e)=>update('password',e.target.value)} placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" /></label>
            <div className="grid grid-cols-2 gap-2"><button className="rounded-xl border px-3 py-2">Ô£ø Apple</button><button className="rounded-xl border px-3 py-2">üîµ Google</button></div>
            <button disabled={!canAuth} onClick={completeAuth} className={"w-full rounded-xl px-4 py-2 "+(canAuth?'bg-black text-white':'bg-gray-200 text-gray-500')}>{mode==='login'?'Continue':'Create account'}</button>
          </div>
        );
      }
      if(step==="claim"){
        return (
          <div className="p-5 space-y-3">
            <div className="text-base font-semibold">Claim your public handle</div>
            <div className="text-xs text-gray-500">Use letters, numbers, _ or . (3‚Äì20 chars). Example: <span className="font-mono">keith.sutherland.uk</span></div>
            <div className="relative">
              <input className={"mt-1 w-full rounded-xl border px-3 py-2 pr-10 "+(taken?'border-red-400':'border-gray-300')} value={form.username} onChange={(e)=>{update('username',e.target.value); checkUsername(e.target.value);}} placeholder="sparkle.clean" />
              <span className="absolute right-2 top-1/2 -translate-y-1/2 text-sm bg-gray-100 text-gray-700 rounded-md px-2 py-0.5">.uk</span>
            </div>
            {form.username && !checking && !taken && validUsername && (<div className="text-xs text-green-600 mt-1">‚úÖ Available</div>)}
            {checking && <div className="text-xs text-gray-500 mt-1">Checking...</div>}
            {taken && <div className="text-xs text-red-500 mt-1">That username is taken. Try another.</div>}
            <button disabled={!validUsername || taken || checking} onClick={finishClaim} className={"w-full rounded-xl px-4 py-2 "+((validUsername && !taken && !checking)?'bg-black text-white':'bg-gray-200 text-gray-500')}>Finish</button>
          </div>
        );
      }
      // edit
      return (
        <div className="p-5 space-y-4">
          <div className="flex items-center justify-between">
            <div className="text-base font-semibold">Your profile</div>
            <button onClick={logout} className="text-xs text-red-600 underline">Log out</button>
          </div>
          <div className="grid grid-cols-1 gap-3">
            <label className="text-sm">Public handle
              <div className="mt-1 flex">
                <span className="inline-flex items-center px-3 rounded-l-xl border border-r-0 bg-gray-50 text-sm text-gray-600">@</span>
                <input className="flex-1 rounded-r-xl border px-3 py-2 text-sm" value={form.username||""} onChange={(e)=>update('username',e.target.value)} placeholder="your.handle" />
                <span className="ml-2 text-sm text-gray-500 self-center">.uk</span>
              </div>
            </label>
            <label className="text-sm">Display name<input className="mt-1 w-full rounded-xl border px-3 py-2" value={form.displayName||""} onChange={(e)=>update('displayName',e.target.value)} placeholder="Sparkle Clean" /></label>
            <label className="text-sm">Headline<input className="mt-1 w-full rounded-xl border px-3 py-2" value={form.headline||""} onChange={(e)=>update('headline',e.target.value)} placeholder="End‚Äëof‚Äëtenancy specialist" /></label>
            <label className="text-sm">About<textarea className="mt-1 w-full rounded-xl border px-3 py-2" rows="4" value={form.about||""} onChange={(e)=>update('about',e.target.value)} placeholder="Professional home & Airbnb cleaners."></textarea></label>
          </div>
          <div className="flex gap-2">
            <button onClick={()=>{ const u={ email:form.email, username:form.username||user?.username||"demo.user", displayName:form.displayName||"Sparkle Clean", headline:form.headline||"End‚Äëof‚Äëtenancy specialist", about:form.about||"Professional home & Airbnb cleaners." }; setUser(u); saveUser(u); }} className="px-4 py-2 rounded-xl bg-black text-white">Save</button>
            <button onClick={()=>onPreview && onPreview({
              handle: form.username || "sparkle.clean",
              displayName: form.displayName || "Sparkle Clean",
              title: form.headline || "End‚Äëof‚Äëtenancy specialist",
              distance: "‚Äî",
              short: "‚Äî",
              cat: "Cleaning",
              coords: {x:50,y:50},
              about: form.about || "Professional home & Airbnb cleaners.",
            })} className="px-4 py-2 rounded-xl border">Preview public profile</button>
          </div>
          <div className="text-xs text-gray-500">Saved locally (browser storage) for demo purposes.</div>
        </div>
      );
    }

    /**************** Main ****************/
    function App(){
      const tabFromHash=(h)=>{
        const v=(h||"").replace("#","").toLowerCase();
        return ["home","categories","chat","profile"].includes(v) ? v[0].toUpperCase()+v.slice(1) : "Home";
      };
      const [activeTab,setActiveTab]=useState(tabFromHash(location.hash));
      const [homeCat,setHomeCat]=useState("");
      const [profileModal,setProfileModal]=useState(null);

      useEffect(()=>{
        const onHash=()=>setActiveTab(tabFromHash(location.hash));
        window.addEventListener("hashchange",onHash);
        return ()=>window.removeEventListener("hashchange",onHash);
      },[]);

      useEffect(()=>{
        const target="#"+activeTab.toLowerCase();
        if(location.hash!==target) history.replaceState(null,"",target+location.search);
      },[activeTab]);

      return (
        <div className="min-h-screen bg-gray-50 p-4">
          <div className="mx-auto max-w-[420px] rounded-3xl border border-gray-200 bg-white shadow-xl overflow-hidden">
            <div className="flex h-[780px] flex-col">
              <div className="flex-1 overflow-hidden relative">
                {activeTab==="Home" && (<Home onOpenDetail={(pro)=>setProfileModal(pro)} selectedCat={homeCat} onMore={()=>setActiveTab("Categories")} />)}
                {activeTab==="Categories" && (<Categories onPick={(cat)=>{setHomeCat(cat); setActiveTab("Home");}} />)}
                {activeTab==="Chat" && (<Messages />)}
                {activeTab==="Profile" && (<ProfileTab onPreview={(pro)=>setProfileModal(pro)} />)}
                {profileModal && (<ProfileModal pro={profileModal} onClose={()=>setProfileModal(null)} />)}
              </div>
              <nav className="grid grid-cols-4 border-t bg-white">
                {["Home","Categories","Chat","Profile"].map(lbl=>(
                  <button key={lbl} onClick={()=>setActiveTab(lbl)} className={"h-14 text-xs "+(activeTab===lbl?"font-semibold text-gray-900":"text-gray-500")+" flex flex-col items-center justify-center gap-0.5"}>
                    <span className="text-lg leading-none">{lbl==="Home"?"üè†": lbl==="Categories"?"üóÇÔ∏è": lbl==="Chat"?"üí¨":"üë§"}</span><span>{lbl}</span>
                  </button>
                ))}
              </nav>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
  </script>
</body>
</html>
